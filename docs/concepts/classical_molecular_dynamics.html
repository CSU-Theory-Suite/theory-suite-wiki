<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Classical Molecular Dynamics &mdash; csu-wiki  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Example Descriptors Workflow using RDKit, Modred, Morfeus &amp; DBStep" href="../running_calculations/example_descriptors_workflow/example_descriptors_workflow.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            csu-wiki
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Computing Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../computing_resources/paton_computing_resources.html">Paton Lab Computing Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computing_resources/kim_computing_resources.html">Kim Lab Computing Resources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Helpful Packages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpful_packages/inhouse.html">In-house</a></li>
<li class="toctree-l1"><a class="reference internal" href="../helpful_packages/external.html">External</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Graphical Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../graphical_software/edition_generation.html">Edition/Generation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Running Calculations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../running_calculations/example_aqme_workflow/example_aqme_workflow.html">Example Workflow in ACME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_calculations/example_goodvibes_workflow/example_goodvibes_workflow.html">Example GoodVibes Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_calculations/example_reggae_workflow/example_reggae_workflow.html">Example REGGAE Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../running_calculations/example_descriptors_workflow/example_descriptors_workflow.html">Example Descriptors Workflow using RDKit, Modred, Morfeus &amp; DBStep</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Classical Molecular Dynamics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#understanding-the-basics">Understanding the Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-1-prepare-system">Step 1: Prepare System</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-minimization">Step 2: Minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-heating">Step 3: Heating</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-4-equilibration">Step 4: Equilibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-5-production">Step 5: Production</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">csu-wiki</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Classical Molecular Dynamics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/concepts/classical_molecular_dynamics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="classical-molecular-dynamics">
<h1>Classical Molecular Dynamics<a class="headerlink" href="#classical-molecular-dynamics" title="Permalink to this heading"></a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#understanding-the-basics" id="id1">Understanding the Basics</a></p></li>
<li><p><a class="reference internal" href="#step-1-prepare-system" id="id2">Step 1: Prepare System</a></p></li>
<li><p><a class="reference internal" href="#step-2-minimization" id="id3">Step 2: Minimization</a></p></li>
<li><p><a class="reference internal" href="#step-3-heating" id="id4">Step 3: Heating</a></p></li>
<li><p><a class="reference internal" href="#step-4-equilibration" id="id5">Step 4: Equilibration</a></p></li>
<li><p><a class="reference internal" href="#step-5-production" id="id6">Step 5: Production</a></p></li>
</ul>
</nav>
<p>Classical Molecular Dynamics (MD) is a simulation technique that makes use of simplifying assumptions about the motions of molecular systems by using Newtonian mechanics.</p>
<section id="understanding-the-basics">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Understanding the Basics</a><a class="headerlink" href="#understanding-the-basics" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt><strong>Force Field</strong></dt><dd><p>An empirical potential energy function. If we know the forces acting in a system, we can calculate how particle positions will change with time using Newton's classical laws of motion. In order to calculate the forces $vec F$ of each particle, we must have a functional description of the potential energy, U, as a function of coordinate space, r.</p>
</dd>
</dl>
<div class="math notranslate nohighlight">
\[\vec F = -\vec\nabla U(r)\]</div>
<a class="reference internal image-reference" href="../_images/Amber_FF_equation.png"><img alt="../_images/Amber_FF_equation.png" src="../_images/Amber_FF_equation.png" style="width: 600px;" /></a>
<p><strong>Standard Forces</strong></p>
<blockquote>
<div><p>For each timestep in the simulation, the force on every atom is calculated. This is the most time-consuming component of the calculation.</p>
<p>Interatomic forces:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Coulombic potential (attractive or repulsive, <span class="math notranslate nohighlight">\(\propto r^{-1}\)</span>)</p></li>
<li><p>Van der Waals (attractive, <span class="math notranslate nohighlight">\(\propto r^{-6}\)</span>)</p></li>
<li><p>Electronic (repulsive, <span class="math notranslate nohighlight">\(\propto r^{-12}\)</span>)</p></li>
</ol>
</div></blockquote>
</div></blockquote>
<p><strong>Integration of Newton's Laws of Motion</strong></p>
<blockquote>
<div><p>Explaining how velocities and positions are stored at different offset steps and updated accordingly.
Algorithm for integrating Newton's laws of motion.</p>
</div></blockquote>
<dl class="simple">
<dt><strong>Stochastic Thermostats</strong></dt><dd><p>Thermostats maintain a constant temperature simulation. The system is coupled to a heat bath that imposes the desired temperature. With stochastic thermostats, this is done by introducing stochastic (random), occasional forces (collisions) on randomly selected particles. The collisions are implemented to ensure the system's energy is appropriately distributed (according to a Boltzmann average). Common examples include the Andersen and Langevin thermostats.</p>
</dd>
<dt><strong>Barostats</strong></dt><dd><p>Many experiments are performed under constant pressure, rather than constant volume, so it's very common to perform MD simulations with a constant pressure ensemble (i.e., NPT). One of the most common is the Monte Carlo Barostat.</p>
</dd>
<dt><strong>Periodic Boundary Conditions</strong></dt><dd><p>Space is &quot;infinite&quot; tiled repeats of simulation box</p>
</dd>
</dl>
</section>
<section id="step-1-prepare-system">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Step 1: Prepare System</a><a class="headerlink" href="#step-1-prepare-system" title="Permalink to this heading"></a></h2>
<ol class="arabic">
<li><dl>
<dt>Find/construct initial structure of your system</dt><dd><p>Once you know what system you want to simulate, the easiest way to set up the system is to find a crystal structure representative of the system you are interested in.</p>
<p>The Protein Data Bank is a database with collections of crystal structures: <a class="reference external" href="https://www.rcsb.org">https://www.rcsb.org</a></p>
<p>You will want your initial structure file to be in the pdb format: <a class="reference external" href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/tutorials/pdbintro.html">https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/tutorials/pdbintro.html</a></p>
<dl>
<dt>Things to consider:</dt><dd><p>1.1) Do you want to simulate a system that has a ligand bound or unbound? If you have a ligand you will need to include additional force field parameters in following steps. A number of small organic molecules have been previously parameterized, so you will have to see if that is the case for your ligand. If it is not, you will need to develop the parameters. There are numerous methods to do this, most common is probably the RESP (C. I. Bayly et. al. J. Phys. Chem. 97, 10269 (1993)) procedure. Either way, if you parameterize something you should include that information in your SI!!!</p>
<blockquote>
<div><ul class="simple">
<li><p>if you are keeping a ligand, you should save the ligand coordinates in SDF format, and delete it from the PDB file. At this point you need to separate protein and non-protein molecules (except ions and water) because they will get different treatment in later steps.</p></li>
</ul>
</div></blockquote>
<p>1.2) Is there a mutation in the crystal structure? Pretty common. Easy fix, just delete the atoms that are not in the residue you want to be there, and change the three letter residue ID. A program used in later steps will be able to identify there are missing atoms in that residue and place them.</p>
<p>1.3) Are there missing residues or heavy atoms? Probably, but it is only an issue if there are consecutive missing residues. There are programs that exist to try and predict positions of missing residues if this is the case. <a class="reference external" href="https://salilab.org/modeller/tutorial/">https://salilab.org/modeller/tutorial/</a></p>
<p>1.4) Are there ions or cofactors present that you don't want to simulate? Probably. Just remove those lines from the pdb file.</p>
<p>1.5) Do you want to keep crystallographic waters? Probably.</p>
<p>1.6) Visualize your system (PyMol and VMD are my go-tos). See if anything looks wrong. For example, there should only be 1 of your system. In some crystallizations there are repeating units. Unless you intentially want to simulate repeating units (which you probably don't) delete the lines in the PDB file associated with repeats.</p>
<p>1.7) Add 'TER' lines to the PDB. 'TER' separates parts in the PDB file that are not covalently linked. If you have a dimer protein you should have two TER lines after the carboxylic acid terminal oxygens. You don't need to add TER between water molecules, tleap will do that for you.</p>
</dd>
</dl>
<p><strong>PRO TIP</strong>: <em>Always read the paper associated with a crystal structure. The authors will disclose if mutations are present, and provide additional information that may be important to know!</em></p>
<ol class="arabic" start="2">
<li><dl>
<dt>tLEAP</dt><dd><p>This is a program that is used to prepare input for AMBER. Before you do anything with tleap make sure you have adjusted any mutated residues. That way, you won't have to worry about adjusting the hydrogens,just the heavy atoms.</p>
<p>First, protonate your system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">source</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">ff14SB</span> <span class="c1">#load in a force field</span>
<span class="o">&gt;</span> <span class="n">source</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">water</span><span class="o">.</span><span class="n">tip3p</span> <span class="c1">#load in a force field</span>
<span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">loadpdb</span> <span class="n">FILENAME</span><span class="o">.</span><span class="n">pdb</span> <span class="c1">#load in a structure</span>
<span class="o">&gt;</span> <span class="n">savepdb</span> <span class="n">x</span> <span class="n">FILENAME_PROTONATED</span><span class="o">.</span><span class="n">pdb</span> <span class="c1">#saves pdb file with everything protonated</span>
<span class="o">&gt;</span> <span class="n">quit</span> <span class="c1">#exit</span>
</pre></div>
</div>
<p>Hydrogens are typically unresolved in crystalization methods. This means the original pdb file will not contain positions of hydrogens. Therefore, you must protonate the system. HOWEVER! I like to protonated my system and then load it into a visualization software to evaluate protonation states, specifically of all HIS residues. Histidine's have two nitrogen atoms that can be protonated, and it will depend on the enrivornment which is more likely the be protonated. It is best practice to manually visualize each HIS residue and declare the protonation state.</p>
<p><em>Evaluating HIS protonation states:</em></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>load protonated pdb into PyMol</p></li>
<li><p>PyMol&gt; hide nonbonded</p></li>
<li><p>PyMol&gt; select &quot;his_residues&quot;, resn hie #tleap automated chooses the epsilon N to be protonated</p></li>
<li><p>Show his_residues selection as licorice and color by element differently to see easily</p></li>
<li><p>PyMol&gt; show sticks, byres all within 5 of his_residues</p></li>
<li><p>display sequence</p></li>
<li><p>open pdb file in text editor</p></li>
<li><p>start looking at each HIS. If you think the delta N should be protonated, go to that HIS in the pbd and change the HIE to HID for each atom. You also need to delete the HE2 hydrogen atom line. When you load the pdb into tleap again it will detect there needs to be a HD2 atom added, and will do so automatically because you named that residue HID.</p></li>
</ol>
</div></blockquote>
<p>Back to tleap:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">source</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">protein</span><span class="o">.</span><span class="n">ff14SB</span> <span class="c1">#load force field</span>
<span class="o">&gt;</span> <span class="n">source</span> <span class="n">leaprc</span><span class="o">.</span><span class="n">water</span><span class="o">.</span><span class="n">TIP3P</span> <span class="c1">#load parameters for water</span>
<span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">loadPdb</span> <span class="n">FILE_WITH_ADJUSTED_HIS_STATES</span><span class="o">.</span><span class="n">pdb</span> <span class="c1">#load protonated pdb file</span>
<span class="o">&gt;</span> <span class="n">solvatebox</span> <span class="n">x</span> <span class="n">TIP3PBOX</span> <span class="mi">12</span> <span class="c1">#Solvate the complex with a cubic water box</span>
<span class="o">&gt;</span> <span class="n">savepdb</span> <span class="n">x</span> <span class="n">FILENAME_SOLVATED</span><span class="o">.</span><span class="n">pdb</span> <span class="c1">#save your pdb with waters so you can determine how many waters</span>
<span class="o">&gt;</span> <span class="n">saveamberparm</span> <span class="n">x</span> <span class="n">temp</span><span class="o">.</span><span class="n">prmtop</span> <span class="n">temp</span><span class="o">.</span><span class="n">rst7</span> <span class="c1">#doing this right now will tell you if your system has a net charge, and the total number of water molecules</span>
<span class="o">&gt;</span> <span class="n">addions</span> <span class="n">x</span> <span class="n">Na</span><span class="o">+</span> <span class="n">Y</span> <span class="c1">#Neutralize system, might replace waters</span>
</pre></div>
</div>
</dd>
</dl>
<p><em>Pay attention to any errors when loading in your pdb structure. An error likely means tleap isn't sure how to deal with something. Warnings on the other hand are just things tleap wants to bring attention to, but these likely aren't fatal. At this point, tleap will probaly give you a warning statement about an unperturbed charge of the unit. This means your system has a charge, and you probably want a neutral system. This is best done straight in the command line.</em></p>
<blockquote>
<div><p><strong>Important</strong>: <em>tleap has a tendency to undervalue the water density. It is typically at a density of ~0.85 g/mL when we know water density should be about 0.998 g/mL. This is an annoying feature of tleap. You should keep this in mind when trying to calculate how many ions you need for a particular ionic concentration. When you are running your simulations you will perform some steps in the NPT ensemble which will allow the box volume to equilibrate, resulting in correct density.</em></p>
<p><em>If you did the saveamberparm command you will see how many waters your system has. Or you should do the following: In a separate terminal window I use the command &quot;grep -c 'WAT' ~SOMEPATH/FILENAME_SOLVATED.pdb&quot;. Divide this number by 3 to get the number of water molecules in your system.</em></p>
<p>I have a code that then will determine how many ions you should add:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">water_residues</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">desired_ionic_conc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">avo</span> <span class="o">=</span> <span class="mf">6.022e23</span> <span class="c1"># molecules/mol</span>
<span class="n">water_mm</span> <span class="o">=</span> <span class="mf">18.01528</span> <span class="c1">#g/mol</span>
<span class="n">water_conversion</span> <span class="o">=</span> <span class="mf">1e-24</span><span class="o">/</span><span class="n">water_mm</span><span class="o">*</span><span class="n">avo</span> <span class="c1">#molecules of water/A^3</span>
<span class="n">water_volume</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">water_residues</span><span class="p">)</span><span class="o">/</span><span class="n">water_conversion</span> <span class="c1">#A^3</span>
<span class="n">number_of_ions</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">desired_ionic_conc</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="o">/</span><span class="mf">1e24</span><span class="o">*</span><span class="mf">6.022e23</span><span class="o">*</span><span class="n">water_volume</span> <span class="c1">#molecules</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You need to add:&#39;</span><span class="p">,</span><span class="n">number_of_ions</span><span class="p">,</span><span class="s1">&#39;ions&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>To Run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">python</span> <span class="n">code</span><span class="o">.</span><span class="n">py</span> <span class="c1">#water_molecules desired_ionic_concentration</span>
</pre></div>
</div>
</li>
</ol>
<blockquote>
<div><p>Now, back in the tleap window:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">addions</span> <span class="n">x</span> <span class="n">Na</span><span class="o">+</span> <span class="n">XX</span> <span class="c1">#However many you need for desired concentration</span>
<span class="o">&gt;</span> <span class="n">addions</span> <span class="n">x</span> <span class="n">Cl</span><span class="o">-</span> <span class="n">XX</span> <span class="c1">#However many you need for desired concentration</span>
<span class="o">&gt;</span> <span class="n">check</span> <span class="n">x</span> <span class="c1">#You will probably get Warning:Close contact.. and that&#39;s okay.</span>
<span class="o">&gt;</span> <span class="n">saveamberparm</span> <span class="n">x</span> <span class="n">FILENAME</span><span class="o">.</span><span class="n">prmtop</span> <span class="n">FILENAME</span><span class="o">.</span><span class="n">rst7</span> <span class="c1">#Save AMBER topology and coordinate files</span>
<span class="o">&gt;</span> <span class="n">savepdb</span> <span class="n">x</span> <span class="n">FILENAME</span><span class="o">.</span><span class="n">pdb</span> <span class="c1">#save your pdb with ions and waters</span>
<span class="o">&gt;</span> <span class="n">quit</span> <span class="c1">#exit</span>
</pre></div>
</div>
<p><em>tleap will automatically generate a 'leap.log' file. You should keep this! Why not include in your SI so others can see exactly how you prepared your system! It's a pretty large file though...</em></p>
<p><strong>PRO TIP</strong>: <em>ALWAYS visualize the system when you think you're all done!</em></p>
</div></blockquote>
</dd>
</dl>
</li>
</ol>
</section>
<section id="step-2-minimization">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Step 2: Minimization</a><a class="headerlink" href="#step-2-minimization" title="Permalink to this heading"></a></h2>
<p>We must minimize our system such that we are starting our simulations in a local energy minimum. The crystal structure probably has some structural artifacts as a result of the procedure. We don't care for that. It is possible that if you start a simulation from the crystal structure your system could immediately blow up due to extreme forceson any one atom, causing the atoms to move an unreasonable amount in a single timestep. Thus, there are minimization algorithms we appy to the system (such as steepest descent). Minimizations are typically done in two steps: 1) water minimization, to allow the solvent to relax around your solute, and 2) system minimization, where you allow the solute to relax.</p>
<blockquote>
<div><p><strong>General initial minimization protocol</strong>: min.1.in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">&amp;</span><span class="n">cntrl</span>
   <span class="n">imin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#flag to start minimization procedure, perform single point energy calc</span>
   <span class="n">ntx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#read positions, but no initial velocity info</span>
   <span class="n">irest</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="c1">#not restarting from a previous point</span>
   <span class="n">ntpr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="c1">#print MD progress every 100 steps</span>
   <span class="n">ntwx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="c1">#write out coordinates every 100 steps</span>
   <span class="n">ioutfm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="c1">#format of the output file (trajectory) with coordinate and velocity info. 1 is the flag for a binary</span>
   <span class="n">NetCDF</span> <span class="n">traj</span> <span class="n">file</span> <span class="p">(</span><span class="n">it</span><span class="s1">&#39;s smaller,has higher precision, and faster to work with.</span>
   <span class="n">ntb</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#periodic boundary conditions are imposed for constant volume</span>
   <span class="n">iwrap</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
   <span class="n">maxcyc</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
   <span class="n">cut</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span>
   <span class="n">ntr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#flag for restraining certain atoms</span>
   <span class="n">restraint_wt</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="c1">#restraint force constant in kcal/(mol A**2)</span>
   <span class="n">restraintmask</span><span class="o">=</span><span class="s2">&quot;:1-454&quot;</span><span class="p">,</span>
<span class="o">/</span>
</pre></div>
</div>
<p>To run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">AMBERHOME</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pmemd</span><span class="o">.</span><span class="n">cuda</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">i</span> <span class="o">../</span><span class="nb">min</span><span class="mf">.1</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">o</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.1</span><span class="o">.</span><span class="n">out</span>
<span class="o">-</span><span class="n">r</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.1</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">x</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.1</span><span class="o">.</span><span class="n">mdcrd</span>
<span class="o">-</span><span class="n">c</span> <span class="o">../</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">rst7</span> <span class="o">-</span><span class="n">p</span> <span class="o">../</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">prmtop</span>
<span class="o">-</span><span class="n">ref</span> <span class="o">../</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">rst7</span> <span class="o">-</span><span class="n">inf</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.1</span><span class="o">.</span><span class="n">mdinfo</span>
</pre></div>
</div>
<p><strong>General follow up minimization protocol</strong>: min.2.in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">cntrl</span>
    <span class="n">imin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ntx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">irest</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">ntpr</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">ntwx</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">ioutfm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">ntb</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">iwrap</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">maxcyc</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">cut</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span>
   <span class="o">/</span>
</pre></div>
</div>
<p>To run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">AMBERHOME</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pmemd</span><span class="o">.</span><span class="n">cuda</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">i</span> <span class="o">../</span><span class="nb">min</span><span class="mf">.2</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">o</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.2</span><span class="o">.</span><span class="n">out</span>
<span class="o">-</span><span class="n">r</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.2</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">x</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.2</span><span class="o">.</span><span class="n">mdcrd</span>
<span class="o">-</span><span class="n">c</span> <span class="o">../</span><span class="n">minimization</span><span class="mf">.1</span><span class="o">/</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.1</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">p</span> <span class="o">../</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">prmtop</span>
<span class="o">-</span><span class="n">inf</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.2</span><span class="o">.</span><span class="n">mdinfo</span>
</pre></div>
</div>
<p><strong>And this is a good point to visualize your system, and make sure it hasn't deviated too much from the initial crystal structure. The way I recommend doing this is in VMD</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">Load</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">initial</span> <span class="n">PDB</span> <span class="p">(</span><span class="n">The</span> <span class="n">one</span> <span class="n">you</span> <span class="n">made</span> <span class="ow">in</span> <span class="n">tleap</span><span class="p">)</span>
<span class="mf">2.</span> <span class="n">Load</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">PDB</span> <span class="kn">from</span> <span class="nn">after</span> <span class="n">your</span> <span class="n">minimizations</span> <span class="p">(</span><span class="n">cpptraj</span> <span class="n">one</span><span class="o">-</span><span class="n">liner</span> <span class="n">to</span> <span class="n">generate</span> <span class="n">a</span> <span class="n">pdb</span> <span class="kn">from</span> <span class="nn">MD</span> <span class="n">coordinates</span><span class="p">:</span> <span class="n">cpptraj</span> <span class="o">-</span><span class="n">p</span> <span class="n">topology</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">prmtop</span> <span class="o">-</span><span class="n">y</span> <span class="n">coordinate</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">coords</span> <span class="o">-</span><span class="n">x</span> <span class="n">output</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">pdb</span> <span class="p">)</span>
<span class="mf">3.</span> <span class="n">In</span> <span class="n">VMD</span> <span class="n">go</span> <span class="n">to</span> <span class="n">Extensions</span> <span class="o">&gt;</span> <span class="n">Analysis</span> <span class="o">&gt;</span> <span class="n">RMSD</span> <span class="n">Calculator</span> <span class="o">&gt;</span> <span class="o">*</span><span class="n">select</span> <span class="n">a</span> <span class="n">molecule</span> <span class="ow">and</span> <span class="n">click</span> <span class="n">Align</span><span class="o">.</span>
<span class="mf">4.</span> <span class="n">Now</span> <span class="n">you</span> <span class="n">just</span> <span class="n">want</span> <span class="n">to</span> <span class="n">make</span> <span class="n">sure</span> <span class="n">nothing</span> <span class="n">crazy</span> <span class="ow">is</span> <span class="n">happening</span><span class="p">,</span> <span class="n">like</span> <span class="nb">any</span> <span class="n">tertiray</span> <span class="ow">or</span> <span class="n">secondary</span> <span class="n">structure</span> <span class="n">issues</span><span class="p">,</span> <span class="k">for</span> <span class="n">example</span><span class="o">.</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="step-3-heating">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Step 3: Heating</a><a class="headerlink" href="#step-3-heating" title="Permalink to this heading"></a></h2>
<p>Now, we must invest some simulation time into unbiasing our system, and getting it to the right thermodynamics properties, such as a particular temperature.</p>
<blockquote>
<div><p><strong>Heating protocol</strong>: heating.in</p>
<dl>
<dt>::</dt><dd><p>Heating from 25 to 303K; NVT for 1 ns;
&amp;cntrl</p>
<blockquote>
<div><blockquote>
<div><p>imin=0,
ntx=1,
irest=0,
ntxo=2,
ntpr=2500, #print MD progress every 2500 steps
ntwr=50000, #restart file written every 50000 steps
iwrap=1,
ntwx=2500, #write out coordinates every 2500 steps
ioutfm=1,
nstlim=500000, #number of MD steps
dt=0.002, #timestep in picoseconds
ntt=3, #thermostat. 3=langevin dynamics flag
tempi=25.,
temp0=303.0,
ig=-1,
gamma_ln=2 #collision frequency in ps^(-1), variable in Langevin dynamics algorithm
ntc=2,
ntf=2,
ntb=1,
cut=12.0,
ntr=1,
restraint_wt=1,
restraintmask=&quot;:1-454&quot;,
nmropt=1,</p>
</div></blockquote>
<p>/</p>
</div></blockquote>
<p>&amp;wt type='TEMP0', istep1=0,istep2=500000,
value1=25.,value2=303.
/
&amp;wt type='END'
/</p>
</dd>
</dl>
<p>To run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">AMBERHOME</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pmemd</span><span class="o">.</span><span class="n">cuda</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">i</span> <span class="o">../</span><span class="n">heating</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">o</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">heating</span><span class="o">.</span><span class="n">out</span>
<span class="o">-</span><span class="n">r</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">heating</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">x</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">heating</span><span class="o">.</span><span class="n">mdcrd</span>
<span class="o">-</span><span class="n">c</span> <span class="o">../</span><span class="n">minimization</span><span class="mf">.2</span><span class="o">/</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.2</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">p</span> <span class="o">../</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">prmtop</span>
<span class="o">-</span><span class="n">inf</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">heating</span><span class="o">.</span><span class="n">mdinfo</span> <span class="o">-</span><span class="n">ref</span> <span class="o">../</span><span class="n">minimization</span><span class="mf">.2</span><span class="o">/</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">min</span><span class="mf">.2</span><span class="o">.</span><span class="n">rst</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="step-4-equilibration">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Step 4: Equilibration</a><a class="headerlink" href="#step-4-equilibration" title="Permalink to this heading"></a></h2>
<p>How do you know if your system is equilibrated? Eh.. you don't ever know... but you can convince yourself it probably is by evaluated properties. For example, if you have an NVT system you can plot volume as a function of timestep and ensure it is fluctuating around the same value with minimal drift. Another common metric, especially for biomolecules, is to examine the root mean squared fluctuations (RMSF) or root mean squared deviations (RMSD) of the residues as a funciton of time.</p>
<blockquote>
<div><p><strong>Equilibration protocol</strong>: equilib.in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Equilib</span> <span class="n">NVT</span> <span class="k">with</span> <span class="n">constraints</span> <span class="k">for</span> <span class="mi">4</span> <span class="n">ns</span><span class="p">;</span>
<span class="o">&amp;</span><span class="n">cntrl</span>
  <span class="n">imin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
  <span class="n">ntx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
  <span class="n">irest</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">ntxo</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
  <span class="n">ntpr</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span>
  <span class="n">ntwr</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span>
  <span class="n">iwrap</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">ntwx</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span>
  <span class="n">ioutfm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">nstlim</span><span class="o">=</span><span class="mi">2000000</span><span class="p">,</span>
  <span class="n">dt</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
  <span class="n">ntt</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
  <span class="n">temp0</span><span class="o">=</span><span class="mf">303.0</span><span class="p">,</span>
  <span class="n">ig</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">gamma_ln</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
  <span class="n">ntc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
  <span class="n">ntf</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
  <span class="n">ntb</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">cut</span><span class="o">=</span><span class="mf">12.0</span><span class="p">,</span>
  <span class="n">ntr</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">restraint_wt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">restraintmask</span><span class="o">=</span><span class="s2">&quot;:1-454&quot;</span><span class="p">,</span>
 <span class="o">/</span>
</pre></div>
</div>
<p>To run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">AMBERHOME</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pmemd</span><span class="o">.</span><span class="n">cuda</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">i</span> <span class="o">../</span><span class="n">equilib</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">o</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">equilib</span><span class="o">.</span><span class="n">out</span>
<span class="o">-</span><span class="n">r</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">equilib</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">x</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">equilib</span><span class="o">.</span><span class="n">mdcrd</span>
<span class="o">-</span><span class="n">c</span> <span class="o">../</span><span class="n">heating</span><span class="o">/</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">heating</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">ref</span> <span class="o">../</span><span class="n">heating</span><span class="o">/</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">heating</span><span class="o">.</span><span class="n">rst</span>
<span class="o">-</span><span class="n">p</span> <span class="o">../</span><span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">prmtop</span> <span class="o">-</span><span class="n">inf</span> <span class="n">igps_wt_apo</span><span class="o">.</span><span class="n">w_ions_solv</span><span class="o">.</span><span class="n">equilib</span><span class="o">.</span><span class="n">mdinfo</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Pro Tip</strong>: <em>Prior to production runs, you may need need an additional &quot;equilibration period&quot;. For example, if you switch to an NPT ensemble, you will need to allow your box volume to adjust to the density of your system (especially if you use tleap to solvate!). In my personal workflow outlined here I &quot;throw out&quot; the first 250 ns of my production run (the next MD step) which I run in the NPT ensemble. So, essentially those first 250 ns are an additional equilibration period. All the production run trajectory after 250 ns are used for analysis.</em></p>
<p><em>Alternatively, if you imposed any restraints during equilibration that are removed in the production run you should account for another period of equilibration.</em></p>
<dl class="simple">
<dt><strong>Volume is important to evaluate!</strong></dt><dd><p><em>In these input files for my production runs I specify the 'cut' flag to be 12.0. This means my long range electrostatics are calculated up to a 12.0 Å cutoff. The importance of this is that this number MUST be smaller that the longest length of my protein minus the smallest box dimension. Otherwise, there could be artificial physical interactions calculated between periodic images. In the next MD step I explain how I calculate this using VMD. I do this after my equiibration is 'complete' (before the trajectory I actually use for analysis).</em></p>
</dd>
</dl>
</section>
<section id="step-5-production">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Step 5: Production</a><a class="headerlink" href="#step-5-production" title="Permalink to this heading"></a></h2>
<p>This will be the data collected for analysis! The essential difference between production and equilibration is simply that we plan to analyze the production data. You never want to perform production runs immediately after altering something about your system (temperature, number of molecules, box size, ensemble, etc). If any of that is done you must give your system time to equilibrate. Otherwise, your data will contain artifacts, and thermodynamic property calculations will not hold true because your system was not at equilibrium. It is common practice to discard some initial chunk of production run trajectory to further ensure the data you analyze is of the equilibrated system. The way I have set up my protocol I run equilibration in the NVT ensemble, but the production runs are NPT, which allows the box the relax to the appropriate volume (which is definitely necessary if you solvated with tleap because the water density was low to start with). Because of this, it is absolutely critical that you observe the volume changes after the first few nanoseconds of production run. Specifically, you must ensure that the box volume is still large enough that your system won't start to interact with its periodic images. You must measure along the longest axis of your system, then add your longe-range non-bonded cutoff value specified in your input file to that number. This is the MINIMUM value for your box dimensions. For example, say your sistem is 74 Å, and you use cut=12.0, then your equilibrated box dimensions must all be more than 86 Å.</p>
<p>Possibly one of the most difficult decisions now is to decide what data to store, and how often to store it. One thing to keep in mind is the time correlation of variables form your simulation. MD observations are time-correlated, therefore it is unneccesary and problematic (in a redundant manner) to store data at each point in time. You must store data in time steps less than the autocorrelation for that specific observable. Alas, we would have no way of knowing the autocorrelation time of a variable until we determine it from simulation, so it is essentially unavoidable to store some redundant data.</p>
<blockquote>
<div><p><strong>Production protocol</strong>: production.in</p>
<p>NPT; no constraints; 10 ns chunks
&amp;cntrl &lt;br /&gt;</p>
<blockquote>
<div><p>imin=0, #no minimization &lt;br /&gt;
irest=1, #flag to restart simulation, reading positions and velocities from a previous restart file
ntx=5, #read coordinates and velocities from a previous restart file
ntpr=2500, #print MD progress every 2500 steps
ntwr=5000, #restart file written every 50000 steps
ntwx=2500, #write out coordinates every 2500 steps
nstlim=5000000, #number of MD steps
dt=0.002, #timestep in picoseconds
ntt=3, #Langevin dynamics
temp0=303.0,
ig=-1,
gamma_ln=2,
ntp=1, #pressure regulation. 1=md with isotropic position scaling
barostat=2, #Monte Carlo barostat
pres0=1.0,#bars
ntc=2, #bonds involving H are constrained according to SHAKE
ntf=2, #bond interactions with H omitted
ntb=2, #periodic boundary conditions are imposed for constant pressure
cut=12.0, #nonbonded cutoff in A
ioutfm=1,#binary NetCDF trajectory. Binaries are smaller, higher precision, and faster to read and write.
iwrap=1, #the coordinates written to the rst and trajectory files will be 'wrapped' into a primary box. Has no effect on energy or forces, it's more of a visual thing. This CAN alter diffusion types of acalculations, so in such cases you want = 0. If you are running long trajectories this might be necessary to keep the coordinate output from overflowing the file formats, resulting in huge files.</p>
</div></blockquote>
<p>/</p>
</div></blockquote>
<p>To run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="n">AMBERHOME</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pmemd</span><span class="o">.</span><span class="n">cuda</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">i</span> <span class="o">../</span><span class="n">Production</span><span class="o">.</span><span class="ow">in</span> <span class="o">-</span><span class="n">o</span> <span class="mi">1</span><span class="n">gpw_holo_wt</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">out</span>
<span class="o">-</span><span class="n">r</span> <span class="mi">1</span><span class="n">gpw_holo_wt</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">rst</span> <span class="o">-</span><span class="n">x</span> <span class="mi">1</span><span class="n">gpw_holo_wt</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">cd</span>
<span class="o">-</span><span class="n">c</span> <span class="o">../</span><span class="n">Production_correct_ntwx</span><span class="o">.</span><span class="n">prev_prod</span><span class="o">/</span><span class="mi">1</span><span class="n">gpw_holo_wt</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">prev_prod</span><span class="o">.</span><span class="n">rst</span>
<span class="o">-</span><span class="n">p</span> <span class="o">../</span><span class="mi">1</span><span class="n">gpw_holo_wt</span><span class="o">.</span><span class="n">prmtop</span> <span class="o">-</span><span class="n">inf</span> <span class="mi">1</span><span class="n">gpw_holo_wt</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">prod</span><span class="o">.</span><span class="n">mdinfo</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../running_calculations/example_descriptors_workflow/example_descriptors_workflow.html" class="btn btn-neutral float-left" title="Example Descriptors Workflow using RDKit, Modred, Morfeus &amp; DBStep" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, csu-theory-suite.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>